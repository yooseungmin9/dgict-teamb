<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="/css/footer.css"/>
  <title>회원가입</title>
  <style>
    :root{
      --gap:16px; --line:#e5e7eb; --ink:#0f172a; --muted:#6b7280;
      --bg:#f8fafc; --card:#ffffff; --primary:#2563eb; --primary-ink:#ffffff;
      --accent:#111827;
    }
    html,body{height:100%}
    body{
      margin:0; background:var(--bg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
      color:var(--ink);
    }
    .container{max-width:640px;margin:40px auto;padding:0 20px}
    .card{
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      padding:28px 28px 22px; box-shadow:0 1px 2px rgba(0,0,0,.03);
    }
    h1{margin:0 0 22px;font-size:24px;letter-spacing:-.2px}
    .grid{
      display:grid; grid-template-columns:220px 1fr; gap:var(--gap) var(--gap);
      align-items:center;
    }
    /* label column */
    .grid label.title{font-weight:600;color:#0b1324}
    /* inputs */
    .input, select{
      height:44px; padding:0 12px; border:1px solid var(--line); border-radius:10px;
      font-size:14px; width:100%; background:#fff; outline:none;
    }
    .input:focus{border-color:#c7d2fe; box-shadow:0 0 0 3px rgba(37,99,235,.12)}
    .help{grid-column:2/3; color:var(--muted); font-size:12px; margin-top:-6px}
    .hr{height:1px;background:var(--line);margin:22px 0}
    /* input group (region + button) */
    .input-group{display:flex; gap:10px; align-items:center}
    .input-group .input{flex:1}
    .btn{
      border:1px solid var(--line); background:var(--accent); color:#fff;
      padding:10px 14px; height:44px; border-radius:10px; cursor:pointer;
      font-weight:600;
    }
    .btn.secondary{background:#fff; color:#0f172a}
    .btn.primary{background:var(--accent);}
    .actions{display:flex; gap:10px; justify-content:flex-end; margin-top:18px}
    /* radio group */
    .radio-group{display:flex; gap:18px; align-items:center}
    .radio{display:flex; align-items:center; gap:8px}
    /* error box */
    .err{
      grid-column:1/3; background:#fff3f3; color:#b00020; border:1px solid #ffd6d6;
      padding:10px 12px; border-radius:10px; margin-top:6px;
    }
    /* responsive */
    @media (max-width: 720px){
      .grid{grid-template-columns:1fr; align-items:stretch}
      .grid label.title{margin-top:10px}
    }
  </style>
</head>
<body>
<div th:replace="fragments/header :: siteHeader"></div>
<main class="container">
  <div class="card">
    <h1>회원가입</h1>

    <!-- 폼 모델은 SignupRequest -->
    <form th:action="@{/member/signup}" th:object="${member}" method="post">

      <div class="grid">
        <label for="id" class="title">아이디</label>
        <input id="id" class="input" type="text" th:field="*{id}" placeholder="아이디" required />

        <label for="password" class="title">비밀번호</label>
        <input id="password" class="input" type="password" th:field="*{password}" placeholder="비밀번호" required />

        <label for="name" class="title">이름</label>
        <input id="name" class="input" type="text" th:field="*{name}" placeholder="이름" required />

        <label for="birthYear" class="title">출생년도</label>
        <input id="birthYear" class="input" type="number" min="1900" max="2099" step="1" th:field="*{birthYear}" placeholder="예: 1995" />

        <label for="phone" class="title">전화번호</label>
        <input id="phone" class="input" type="tel" th:field="*{phone}" placeholder="010-1234-5678" />

        <label for="region" class="title">지역</label>
        <div class="input-group">
          <input id="region" class="input" type="text" th:field="*{region}" placeholder="예: 서울 강남구" />
          <button type="button" class="btn secondary" id="btnAddr">주소찾기</button>
        </div>

        <label class="title">성별</label>
        <div class="radio-group">
          <label class="radio"><input type="radio" th:field="*{gender}" value="남" /> 남</label>
          <label class="radio"><input type="radio" th:field="*{gender}" value="여" /> 여</label>
        </div>

        <!-- 에러 메시지 (BindingResult를 쓸 때만 표시) -->
        <div class="err" th:if="${#fields != null and #fields.hasAnyErrors()}">
          <p th:each="e : ${#fields.allErrors()}" th:text="${e}">폼 오류 메시지</p>
        </div>
      </div>

      <div class="hr"></div>

      <div class="actions">
        <a class="btn secondary" th:href="@{/pages/dashboard}">취소</a>
        <button class="btn primary" type="submit">가입하기</button>
      </div>
    </form>
  </div>
</main>
<div th:replace="fragments/footer :: siteFooter"></div>

<!-- 전화번호 자동 하이픈 -->
<script>
  (function(){
    const $p = document.getElementById('phone');
    if(!$p) return;
    const fmt = v => {
      v = v.replace(/[^0-9]/g,'');
      // 02 국번
      if(/^02/.test(v)){
        if(v.length <= 2) return '02';
        if(v.length <= 6) return `02-${v.slice(2)}`;
        if(v.length <= 10) return `02-${v.slice(2,6)}-${v.slice(6,10)}`;
        return `02-${v.slice(2,6)}-${v.slice(6,10)}`;
      }
      // 휴대폰/일반
      if(v.length < 4) return v;
      if(v.length < 7) return `${v.slice(0,3)}-${v.slice(3)}`;
      return `${v.slice(0,3)}-${v.slice(3,7)}-${v.slice(7,11)}`;
    };
    let last = '';
    $p.addEventListener('input', () => {
      const cur = fmt($p.value);
      if(cur !== last){ $p.value = cur; last = cur; }
    });
  })();
</script>

<!-- 다음(카카오) 주소 API -->
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
  const btn = document.getElementById('btnAddr');
  if(btn){
    btn.addEventListener('click', function(){
      new daum.Postcode({
        oncomplete: function(data) {
          const addr = data.roadAddress || data.jibunAddress || '';
          const regionInput = document.getElementById('region');
          if(regionInput) regionInput.value = addr;
        }
      }).open();
    });
  }
</script>
</body>
</html>
