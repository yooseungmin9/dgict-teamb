<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <title>써머릭스 SUMMARIX</title>
  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="/css/dashboard-grid.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script defer src="/js/sentiment.js"></script>
  <script defer src="/js/trands.js"></script>
  <script defer src="/js/app.js"></script>
</head>
<body data-page="dashboard">
<!-- 헤더는 프래그먼트 호출만 -->
<div th:replace="fragments/header :: siteHeader"></div>

<main class="dash">
  <div class="container">
    <!-- 헤드라인 영역 -->
    <div class="dash__headline">
      <h2>~ 글로벌 뉴스 속보 모니터링 ~</h2>
    </div>
    <div>
      <button class="report-btn" type="button" id="aiReportBtn">AI 리포트 생성</button>
    </div>

    <!-- 3열 그리드 -->
    <section class="dash__grid">
      <!-- 좌열 -->
      <!-- dashboard.html : #panel-sentiment-series 블록만 교체 -->
      <div class="stack" id="col-left">
        <div class="card" id="panel-sentiment-series">
          <!-- [설명] 기존 제목/placeholder 제거, 제공 카드 삽입 -->
          <article class="card__body">
            <div class="feature-card" id="sentiment-card"
                 data-api="http://127.0.0.1:8000/sentiment/line">

                <strong>긍·부정추이</strong>
                <div class="controls" style="display:flex; gap:8px; align-items:center; margin-left:auto;">
                  <button id="btn-mode-count" class="btn btn--sm">건수</button>
                  <button id="btn-mode-ratio" class="btn btn--sm">비율</button>
                  <button id="btn-g-day"   class="btn btn--sm">일별</button>
                  <button id="btn-g-week"  class="btn btn--sm">주별</button>
                  <button id="btn-g-month" class="btn btn--sm">월별</button>
                </div>
                <div id="sentiment-status" style="font-size:12px;color:#666;margin:4px 0;">준비됨</div>
                <div style="height:400px;">
                  <canvas id="sentiment-chart"><!-- Chart.js가 이 캔버스에 그립니다 --></canvas>
                </div>

            </div>
          </article>
        </div>
      </div>

      <!-- 중앙열 -->
      <div class="stack" id="col-center">
        <div class="card" id="panel-hot-topic-yesterday">
          <div class="card__title">키워드 핫토픽 (어제 대비)</div>
          <div class="card__body placeholder">핫토픽 리스트/차트</div>
        </div>

        <div class="card" id="panel-news-count">
          <div class="card__title">분석된 뉴스 개수</div>
          <div class="card__body placeholder">카운트/스파크라인</div>
        </div>

        <div class="card" id="panel-today-sentiment">
          <div class="card__title">오늘의 감성점수 수집된것 (백분율)</div>
          <div class="card__body placeholder">파이/도넛</div>
        </div>

        <div class="card" id="panel-tbd">
          <div class="card__title">미정</div>
          <div class="card__body placeholder">추후 위젯</div>
        </div>
      </div>

      <!-- 우열 -->
      <div class="stack" id="col-right">
          <div class="card" id="panel-keyword-rank">
              <div class="card__body">
                  <strong>키워드 랭킹</strong>
                  <!-- ▼ trends.html의 .ranking-section 본문 이식 (제목 h3 제거) -->
                  <div class="controls" style="margin-bottom:6px;">
                      <!-- 보기 모드 -->
                      <label><input type="radio" name="DB_kwMode" value="category" checked /> 카테고리별</label>
                      <label><input type="radio" name="DB_kwMode" value="global" /> 통합</label>

                      <!-- 기간(일) -->
                      <label class="muted">기간(일)
                          <select id="DB_kwDays">
                              <option value="30" selected>30</option>
                              <option value="60">60</option>
                              <option value="90">90</option>
                          </select>
                      </label>
                  </div>

                  <!-- 탭 버튼 -->
                  <div id="DB_kwTabs" style="margin:6px 0; display:flex; gap:6px; flex-wrap:wrap;"></div>

                  <table id="DB_kwTable" class="ranking-table">
                      <thead>
                      <tr>
                          <th style="width:64px;">순위</th>
                          <th>키워드</th>
                          <th class="right" style="width:100px;">언급량</th>
                      </tr>
                      </thead>
                      <tbody id="DB_keywordRankingBody"></tbody>
                  </table>
              </div>
          </div>

        <div class="row-2">
          <div class="card" id="panel-opinion">
            <div class="card__title">오피니언 마이닝 요약</div>
            <div class="card__body placeholder">요약 텍스트</div>
          </div>
        </div>
      </div>

        <div class="card" id="panel-hot-datalab">
            <div class="card__body">
                <strong>키워드 핫토픽 그래프 (데이터랩)</strong>
                <div class="controls" style="margin-bottom:8px;">
                    <label class="muted">표시 기간(일)
                        <select id="DB_trendDays">
                            <option value="30" selected>30</option>
                            <option value="60">60</option>
                            <option value="90">90</option>
                        </select>
                    </label>
                </div>
                <div class="chart-container">
                    <canvas id="DB_categoryTrendChart"></canvas>
                </div>
            </div>
        </div>
    </section>
  </div>
</main>

</body>

<script th:inline="javascript">
  (function () {
    function go(el) {
      var url = el.dataset.url;
      if (url) window.location.href = url;
    }
    function onClick(e) { go(e.currentTarget); }
    function onKey(e) {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); go(e.currentTarget); }
    }
    var links = document.querySelectorAll('[data-url]');
    links.forEach(function (el) {
      el.addEventListener('click', onClick);
      el.addEventListener('keydown', onKey);
      el.style.cursor = 'pointer';
    });
  })();
</script>
</html>
