<!-- templates/chat.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title id="appTitle">AI ê²½ì œ ìƒë‹´ë´‡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" th:href="@{/css/style.css}" />
  <link rel="stylesheet" href="/css/footer.css"/>
  <link rel="stylesheet" href="/css/header.css"/>
  <style>
    :root { color-scheme: light dark; }
    html, body { scroll-behavior: smooth; }
    .bubble { max-width: 80%; }
    .dot { animation: blink 1.4s infinite both }
    .dot:nth-child(2){ animation-delay:.2s }
    .dot:nth-child(3){ animation-delay:.4s }
    @keyframes blink{ 0%,80%,100%{opacity:0} 40%{opacity:1} }
    .scroll-thin::-webkit-scrollbar{ width:10px }
    .scroll-thin::-webkit-scrollbar-thumb{ background:#cbd5e1; border-radius:8px }
    @media (prefers-color-scheme: dark){
        .scroll-thin::-webkit-scrollbar-thumb{ background:#475569 }
    }
    .chatbot-container { position: relative; }
    .top-controls {
      position: absolute; top: 8px; right: 8px;
      display: flex; flex-direction: column; gap: 6px; align-items: flex-end;
    }
    .top-controls select { padding: 4px; font-size: 14px; }
    </style>
</head>
<body>
  <div th:replace="~{fragments/header :: siteHeader}"></div>

  <main class="main">
    <div class="container">
      <h2 id="pageHeading" class="page-title">ê²½ì œ ì§ˆë¬¸ ì±—ë´‡</h2>

      <div class="global-controls">
        <!-- â–¼ ì–¸ì–´ ì „í™˜ì‹œ ë¼ë²¨/ë²„íŠ¼/í”Œë ˆì´ìŠ¤í™€ë”/í™˜ì˜ë©˜íŠ¸ë„ ë°”ë€Œê²Œ JSì—ì„œ ì²˜ë¦¬ -->
        <label id="labelLang" for="langSelect" class="sr-only">ì–¸ì–´</label>
        <select id="langSelect" aria-label="ìŒì„± ì¸ì‹ ì–¸ì–´">
          <option value="ko-KR">í•œêµ­ì–´</option>
          <option value="en-US">English</option>
        </select>

        <!-- â–¼ ì´ˆê¸°í™” ë²„íŠ¼(â€œì „ì²´ í™”ë©´ ì´ˆê¸°í™”â€) -->
        <button id="resetBtn" type="button" class="btn btn--secondary">ëŒ€í™” ì´ˆê¸°í™”</button>
      </div>

      <div class="chatbot-container">
        <!-- â–¼ JSê°€ í™˜ì˜ë©˜íŠ¸/ìƒíƒœ/ëŒ€í™”ë‚´ìš©ì„ ë Œë”í•˜ë„ë¡ ë¹„ì›Œë‘  -->
        <div id="chat" class="chat-messages"></div>

        <form id="chatForm" class="chat-form flex-row">
          <textarea id="messageInput" rows="1" placeholder="ì§ˆë¬¸ì„ ë§í•˜ê±°ë‚˜ ì…ë ¥í•˜ì„¸ìš”..." class="chat-input-auto"></textarea>
          <div class="btn-group">
            <button id="sttStartBtn" type="button" class="btn btn--secondary">ğŸ¤ï¸</button>
            <button id="sttStopBtn"  type="button" class="btn btn--secondary" disabled>â¹</button>
            <button id="sendBtn"  type="submit" class="btn btn--primary">ì „ì†¡</button>
            <button id="ttsBtn"   type="button" class="btn btn--secondary">ğŸ”ˆ ë‹µë³€ ë“£ê¸°</button>
          </div>
        </form>

        <audio id="ttsAudio" controls class="hidden"></audio>
      </div>

      <!-- ì˜ˆì‹œì§ˆë¬¸ -->
      <div class="faq-row" aria-label="ì˜ˆì‹œ ì§ˆë¬¸">
        <button type="button" class="btn btn--ghost faq-item" data-question="ìµœì‹  ê²½ì œ ë‰´ìŠ¤ Top5 ì•Œë ¤ì¤˜">ìµœì‹  ê²½ì œ ë‰´ìŠ¤ Top5 ì•Œë ¤ì¤˜</button>
        <button type="button" class="btn btn--ghost faq-item" data-question="ì´ ì›¹ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì•Œë ¤ì¤˜">ì´ ì›¹ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì•Œë ¤ì¤˜</button>
        <button type="button" class="btn btn--ghost faq-item" data-question="ê¸ˆë¦¬ê°€ ë¬´ì—‡ì´ë©°, í•œêµ­ì€í–‰ ê¸°ì¤€ê¸ˆë¦¬ëŠ” ëª‡ %ì¸ê°€ìš”?">ê¸ˆë¦¬ ìš©ì–´ì„¤ëª…ê³¼ í•œêµ­ ê¸°ì¤€ê¸ˆë¦¬ ì•Œë ¤ì¤˜</button>
        <button type="button" class="btn btn--ghost faq-item" data-question="ì›ìì¬ê°’ì´ ê²½ì œì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì•Œë ¤ì¤˜">ì›ìì¬ê°’ì´ ê²½ì œì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì•Œë ¤ì¤˜</button>
        <button type="button" class="btn btn--ghost faq-item" data-question="í˜„ì¬ ì£¼ìš” ì§€ìˆ˜ì™€ í™˜ìœ¨ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”??">í˜„ì¬ ì£¼ìš” ì§€ìˆ˜ì™€ í™˜ìœ¨ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”??</button>
      </div>
    </div>
  </main>

  <div th:replace="~{fragments/footer :: siteFooter}"></div>

  <script src="/js/chat.js"></script>
</body>
</html>