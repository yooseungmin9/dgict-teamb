<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100dvh; background: #e8f2fb;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Arial, sans-serif;
      display: grid; place-items: center;
    }
    .login { position: relative; width: min(92vw, 380px); margin: auto; background: transparent; padding: 60px 20px 28px; }
    .avatar { width: 96px; height: 96px; border: 3px solid #2f76c2; border-radius: 50%; margin: 0 auto 20px; display: grid; place-items: center; }
    .avatar svg { width: 54px; height: 54px; fill: #2f76c2; }
    .field { position: relative; margin: 10px 0; }
    .field input {
      width: 100%; height: 48px; padding: 0 56px 0 44px;
      border: 2px solid #2f76c2; border-radius: 10px; background: white;
      font-size: 16px; color: #0d3f70; outline: none;
    }
    .field input::placeholder { color: #7aa8d9; }
    .field input:focus { box-shadow: 0 0 0 3px rgba(47,118,194,0.15); }
    .left-icon, .right-icon {
      position: absolute; top: 50%; transform: translateY(-50%); display: grid; place-items: center; color: #2f76c2;
    }
    .left-icon { left: 8px; width: 32px; height: 32px; }
    .right-icon { right: 6px; width: 25px; height: 25px; cursor: pointer; background: transparent; border: none; border-radius: 6px; }
    .right-icon svg { width: 20px; height: 20px; }
    .right-icon:hover { background: rgba(47,118,194,0.1); border: 1px solid #2f76c2; }
    .row { display: flex; align-items: center; justify-content: space-between; gap: 12px; margin: 8px 2px 18px; font-size: 14px; color: #0d3f70; }
    .row a { color: #7aa8d9; text-decoration: none; }
    .row a:hover { text-decoration: underline; }
    .btn { width: 100%; height: 52px; border: 0; border-radius: 10px; background: #1e73be; color: #fff; font-size: 18px; letter-spacing: .5px; cursor: pointer; }
    .btn:hover { background: #185e9c; }
    .error { margin: 6px 2px 0; color: #d64545; font-size: 13px; min-height: 18px; }
    .back-btn { position: absolute; top: 8px; left: 0; width: 32px; height: 32px; padding: 0; border: none; background: none; cursor: pointer; }
    .back-btn img { width: 100%; height: 100%; object-fit: contain; }
    .back-btn:hover img { opacity: .8; }
  </style>
</head>
<body>

<!-- 서버로 전송: POST /pages/login -->
<form class="login" id="loginForm" th:action="@{/pages/login}" method="post" novalidate>
  <!-- (Spring Security 사용 시 CSRF 필요)
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
  -->

  <!-- 뒤로가기 -->
  <button type="button" class="back-btn" onclick="history.back()">
    <img src="/img/back.png" alt="뒤로가기" />
  </button>

  <!-- 아이콘 -->
  <div class="avatar" aria-hidden="true">
    <svg viewBox="0 0 24 24">
      <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z" />
    </svg>
  </div>

  <!-- ID(=username) -->
  <div class="field">
    <span class="left-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"/></svg>
    </span>
    <!-- ★ name="id" 로 맞춤 (서비스가 id 기반 인증) -->
    <input id="id" name="id" type="text" placeholder="ID" autocomplete="username" aria-label="ID" required />
  </div>

  <!-- Password -->
  <div class="field">
    <span class="left-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24"><path fill="currentColor" d="M17 8V7a5 5 0 0 0-10 0v1H5v12h14V8Zm-8 0V7a3 3 0 0 1 6 0v1Z"/></svg>
    </span>
    <input id="password" name="password" type="password" placeholder="Password"
           autocomplete="current-password" aria-label="Password" required minlength="4" />
    <button type="button" class="right-icon" id="togglePw" aria-label="비밀번호 보이기 전환" title="비밀번호 보기/숨기기">
      <svg id="eyeOff" viewBox="0 0 24 24">
        <path fill="currentColor" d="M2 5.27 3.28 4l17 17L19.73 22l-3.2-3.2A10.73 10.73 0 0 1 12 20C6 20 2 12 2 12a17.5 17.5 0 0 1 4.11-5.55L2 5.27ZM12 7a5 5 0 0 1 5 5 4.91 4.91 0 0 1-.47 2.12L14.59 12A2.5 2.5 0 0 0 12 9.41L9.88 7.29A4.91 4.91 0 0 1 12 7Zm10 5s-1.64 3.11-4.27 5.19l-1.42-1.42C18.52 14.4 20 12 20 12s-3-6-8-6a9.69 9.69 0 0 0-3 .5L7.46 4.96A11.14 11.14 0 0 1 12 4c6 0 10 8 10 8Z"/>
      </svg>
    </button>
  </div>

  <!-- 오류 메시지(서버에서 내려온 메시지 표시) -->
  <div id="error" class="error" role="alert" aria-live="polite" th:text="${error}"></div>

  <!-- Remember / Forgot -->
  <div class="row">
    <label><input id="remember" type="checkbox" /> Remember me</label>
    <a href="#" id="forgot">Forgot password?</a>
  </div>

  <!-- 로그인 버튼 -->
  <button class="btn" type="submit">LOGIN</button>
</form>

<script>
  // 비밀번호 토글
  (function () {
    const input = document.getElementById('password');
    const btn = document.getElementById('togglePw');
    const eyeOn = `
      <svg id="eyeOn" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12 4c6 0 10 8 10 8s-4 8-10 8S2 12 2 12s4-8 10-8Zm0 2C7.58 6 4.22 10.2 3.07 12 4.22 13.8 7.58 18 12 18s7.78-4.2 8.93-6C19.78 10.2 16.42 6 12 6Zm0 3a3 3 0 1 1-3 3 3 3 0 0 1 3-3Z"/>
      </svg>`;
    const eyeOff = btn.innerHTML;
    btn.addEventListener('click', () => {
      const isPw = input.type === 'password';
      input.type = isPw ? 'text' : 'password';
      btn.innerHTML = isPw ? eyeOn : eyeOff;
    });
  })();

  // Remember me: 폼 전송 전에 저장
  (function () {
    const form = document.getElementById('loginForm');
    const remember = document.getElementById('remember');
    const idInput = document.getElementById('id');

    // 저장된 값 복원
    const saved = localStorage.getItem('demo_login_id');
    if (saved) { idInput.value = saved; remember.checked = true; }

    // 실제 전송(기본 submit) 전 remember 처리
    form.addEventListener('submit', () => {
      if (remember.checked) localStorage.setItem('demo_login_id', idInput.value);
      else localStorage.removeItem('demo_login_id');
      // ★ 여기서는 e.preventDefault() 안 씀 → 서버로 정상 POST 전송
    });
  })();
</script>
</body>
</html>
